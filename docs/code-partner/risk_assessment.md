# 风险评估参考指南

## 常见风险类别

### 1. 架构风险

| 风险项 | 检查要点 | 替代方案 |
|--------|----------|----------|
| **单例模式破坏** | 是否创建重复实例？ | 使用依赖注入或工厂模式 |
| **循环依赖** | 模块间相互引用？ | 重构为事件驱动或中间层 |
| **紧耦合** | 修改影响面过大？ | 引入接口抽象层 |
| **过度设计** | 引入不必要的抽象？ | YAGNI原则，延迟实现 |

### 2. 并发风险

| 风险项 | 检查要点 | 替代方案 |
|--------|----------|----------|
| **竞态条件** | 共享状态未保护？ | 使用锁/原子操作/无锁结构 |
| **死锁风险** | 多锁获取顺序？ | 统一锁顺序或超时机制 |
| **资源泄漏** | 线程/连接未释放？ | 使用上下文管理器或连接池 |

### 3. 性能风险

| 风险项 | 检查要点 | 替代方案 |
|--------|----------|----------|
| **API 成本** | 外部调用频率？ | 批量处理/缓存/限流 |
| **内存爆炸** | 大对象/无限增长？ | 分页处理/流式/LRU缓存 |
| **延迟增加** | 同步阻塞操作？ | 异步化/并行处理 |
| **数据库负载** | N+1查询/全表扫描？ | 批量查询/索引优化 |

### 4. 可维护性风险

| 风险项 | 检查要点 | 替代方案 |
|--------|----------|----------|
| **技术债务** | 快速hack方案？ | 记录技术债务清单 |
| **测试盲区** | 未覆盖边界情况？ | 补充单元测试/集成测试 |
| **文档过时** | 行为与文档不符？ | 同步更新文档 |
| **依赖过重** | 引入巨型库？ | 寻找轻量替代品 |

### 5. 安全风险

| 风险项 | 检查要点 | 替代方案 |
|--------|----------|----------|
| **注入攻击** | 用户输入拼接到代码？ | 参数化查询/输入验证 |
| **敏感数据** | 密钥/凭证硬编码？ | 环境变量/密钥管理服务 |
| **权限提升** | 未校验操作权限？ | 实施RBAC/ABAC |

## 风险等级判定

| 等级 | 特征 | 响应 |
|------|------|------|
| 🟢 低 | 影响局部，易回滚 | 记录后执行 |
| 🟡 中 | 影响多模块，需测试 | 警告+建议+确认后执行 |
| 🔴 高 | 影响核心，难回滚 | 强烈警告+提供替代方案+用户确认 |

## 评估流程

1. **识别风险类别**：从上述5类中定位
2. **检查具体风险点**：对照检查要点
3. **判定风险等级**：参考等级表
4. **制定响应策略**：
   - 🟢 直接执行并记录
   - 🟡 警告 + 优化建议 + 等待确认
   - 🔴 强烈警告 + 替代方案 + 必须确认
